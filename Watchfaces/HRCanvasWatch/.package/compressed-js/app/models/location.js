define({name:"models/location",requires:["core/event"],def:function modelsLocation(C){var P=C,K="GPS",z=null,a=null,i={latitude:null,longitude:null,altitude:null,heading:null,speed:null,timestamp:null,date:null};var D=i;var F=i;var j,L,g,B,k,G;var u=false;var M="";var q={enableHighAccuracy:true,timeout:10000,maximumAge:900000};var e={sampleInterval:1000,callbackInterval:10000};var b=false;var v=false;var w=null,c,Q=performance.timing.navigationStart;function o(){return F;}function J(){return u;}function h(){return D;}function n(R,S){q={sampleInterval:R,callbackInterval:S};}function I(){return q;}function O(){F=i;}function l(R){L=new Date(R);g=L.getHours();B="0"+L.getMinutes();k="0"+L.getSeconds();G=g+":"+B.substr(-2)+":"+k.substr(-2);return G;}function f(R){if(u&&(Math.abs(D.latitude-R.latitude)>=0.05||Math.abs(D.longitude-R.longitude)>=0.05)){P.fire("distanceChange","distanceChange");}}function x(R){j=R.coords;L=new Date(R.timestamp);F={latitude:j.latitude,longitude:j.longitude,altitude:j.altitude,heading:j.heading,speed:j.speed,timestamp:R.timestamp,date:l(R.timestamp)};f(j);D=F;if(!u){u=true;P.fire("found",u);}P.fire("change",o());m();}function p(R){if(R.gpsInfo){j=R.gpsInfo[0];L=new Date(R.timestamp);F={latitude:j.latitude,longitude:j.longitude,altitude:j.altitude,speed:j.speed,timestamp:j.timestamp,date:l(j.timestamp)};f(j);D=F;if(!u){u=true;P.fire("found",u);}P.fire("change",o());m();}else{console.error("Location fallback gpsInfo issue");P.fire("error","gpsInfo issue");}}function s(){console.warn("doFallback");b=true;z.start(K,p,d,e);}function d(R){M=R.message;console.error("Location error :"+R.message);s();}function E(R){switch(R.code){case R.TIMEOUT:P.fire("error",R.message);s();break;default:P.fire("error",R.message);console.error(R.message);}}function r(){if(!v){a=navigator.geolocation.watchPosition(x,E,q);}v=true;}function m(){if(a!==null){navigator.geolocation.clearWatch(a);a=null;}if(b){z.stop(K);b=false;}v=false;}function A(R){console.log("triggerLocationUpdate");m();r();}function N(){P.on({"views.radial.update":A});}function t(R){c=R;}function y(R){if(w==null){w=R;}if(R-w>=c){w=R;r();}}function H(){N();O();z=(tizen&&tizen.humanactivitymonitor)||(window.webapis&&window.webapis.motion)||null;}return{init:H,start:r,stop:m,getPositionAquiered:J,getData:o,setOptions:n,setIntervalUpdate:t,handleUpdate:y};}});